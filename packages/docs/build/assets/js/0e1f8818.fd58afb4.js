"use strict";(self.webpackChunknext_auth_docs=self.webpackChunknext_auth_docs||[]).push([[8585],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),s=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,c=u(e,["components","mdxType","originalType","parentName"]),m=s(n),d=a,f=m["".concat(l,".").concat(d)]||m[d]||p[d]||o;return n?r.createElement(f,i(i({ref:t},c),{},{components:n})):r.createElement(f,i({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var u={};for(var l in t)hasOwnProperty.call(t,l)&&(u[l]=t[l]);u.originalType=e,u.mdxType="string"==typeof e?e:a,i[1]=u;for(var s=2;s<o;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8215:function(e,t,n){var r=n(7294);t.Z=function(e){var t=e.children,n=e.hidden,a=e.className;return r.createElement("div",{role:"tabpanel",hidden:n,className:a},t)}},6396:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(7462),a=n(7294),o=n(2389),i=n(9443);var u=function(){var e=(0,a.useContext)(i.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},l=n(9521),s=n(6010),c="tabItem_vU9c";function p(e){var t,n,r,o=e.lazy,i=e.block,p=e.defaultValue,m=e.values,d=e.groupId,f=e.className,h=a.Children.map(e.children,(function(e){if((0,a.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),v=null!=m?m:h.map((function(e){var t=e.props;return{value:t.value,label:t.label}})),y=(0,l.lx)(v,(function(e,t){return e.value===t.value}));if(y.length>0)throw new Error('Docusaurus error: Duplicate values "'+y.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var g=null===p?p:null!=(t=null!=p?p:null==(n=h.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(r=h[0])?void 0:r.props.value;if(null!==g&&!v.some((function(e){return e.value===g})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+g+'" but none of its children has the corresponding value. Available values are: '+v.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var k=u(),b=k.tabGroupChoices,O=k.setTabGroupChoices,x=(0,a.useState)(g),E=x[0],M=x[1],w=[],T=(0,l.o5)().blockElementScrollPositionUntilNextRender;if(null!=d){var N=b[d];null!=N&&N!==E&&v.some((function(e){return e.value===N}))&&M(N)}var P=function(e){var t=e.currentTarget,n=w.indexOf(t),r=v[n].value;r!==E&&(T(t),M(r),null!=d&&O(d,r))},D=function(e){var t,n=null;switch(e.key){case"ArrowRight":var r=w.indexOf(e.currentTarget)+1;n=w[r]||w[0];break;case"ArrowLeft":var a=w.indexOf(e.currentTarget)-1;n=w[a]||w[w.length-1]}null==(t=n)||t.focus()};return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":i},f)},v.map((function(e){var t=e.value,n=e.label;return a.createElement("li",{role:"tab",tabIndex:E===t?0:-1,"aria-selected":E===t,className:(0,s.Z)("tabs__item",c,{"tabs__item--active":E===t}),key:t,ref:function(e){return w.push(e)},onKeyDown:D,onFocus:P,onClick:P},null!=n?n:t)}))),o?(0,a.cloneElement)(h.filter((function(e){return e.props.value===E}))[0],{className:"margin-vert--md"}):a.createElement("div",{className:"margin-vert--md"},h.map((function(e,t){return(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==E})}))))}function m(e){var t=(0,o.Z)();return a.createElement(p,(0,r.Z)({key:String(t)},e))}},9443:function(e,t,n){var r=(0,n(7294).createContext)(void 0);t.Z=r},1338:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return p},toc:function(){return m},default:function(){return f}});var r=n(7462),a=n(3366),o=(n(7294),n(3905)),i=n(6396),u=n(8215),l=["components"],s={id:"mikro-orm",title:"MikroORM"},c=void 0,p={unversionedId:"adapters/mikro-orm",id:"adapters/mikro-orm",isDocsHomePage:!1,title:"MikroORM",description:"To use this Adapter, you need to install Mikro ORM, the driver that suits your database, and the separate @next-auth/mikro-orm-adapter package:",source:"@site/docs/adapters/mikro-orm.md",sourceDirName:"adapters",slug:"/adapters/mikro-orm",permalink:"/adapters/mikro-orm",editUrl:"https://github.com/nextauthjs/docs/edit/main/docs/adapters/mikro-orm.md",tags:[],version:"current",lastUpdatedBy:"Bal\xe1zs Orb\xe1n",lastUpdatedAt:1643982356,formattedLastUpdatedAt:"2/4/2022",frontMatter:{id:"mikro-orm",title:"MikroORM"},sidebar:"docs",previous:{title:"Sequelize",permalink:"/adapters/sequelize"},next:{title:"Dgraph",permalink:"/adapters/dgraph"}},m=[{value:"Setup",id:"setup",children:[{value:"Passing custom entities",id:"passing-custom-entities",children:[],level:3},{value:"Including the default entities in your MikroORM config",id:"including-the-default-entities-in-your-mikroorm-config",children:[],level:3}],level:2}],d={toc:m};function f(e){var t=e.components,n=(0,a.Z)(e,l);return(0,o.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"To use this Adapter, you need to install Mikro ORM, the driver that suits your database, and the separate ",(0,o.kt)("inlineCode",{parentName:"p"},"@next-auth/mikro-orm-adapter")," package:"),(0,o.kt)(i.Z,{groupId:"npm2yarn",mdxType:"Tabs"},(0,o.kt)(u.Z,{value:"npm",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install next-auth @next-auth/mikro-orm-adapter @mikro-orm/core@next @mikro-orm/[YOUR DRIVER]@next\n"))),(0,o.kt)(u.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add next-auth @next-auth/mikro-orm-adapter @mikro-orm/core@next @mikro-orm/[YOUR DRIVER]@next\n")))),(0,o.kt)("p",null,"Configure NextAuth.js to use the MikroORM Adapter:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="pages/api/auth/[...nextauth].ts"',title:'"pages/api/auth/[...nextauth].ts"'},'import NextAuth from "next-auth"\nimport { MikroOrmAdapter } from "@next-auth/mikro-orm-adapter"\n\n\nexport default NextAuth({\n  adapter: MikroOrmAdapter({\n    // MikroORM options object. Ref: https://mikro-orm.io/docs/next/configuration#driver\n    dbName: "./db.sqlite",\n    type: "sqlite",\n    debug: process.env.DEBUG === "true" || process.env.DEBUG?.includes("db"),\n  }),\n  providers: [],\n})\n')),(0,o.kt)("h2",{id:"setup"},"Setup"),(0,o.kt)("h3",{id:"passing-custom-entities"},"Passing custom entities"),(0,o.kt)("p",null,"The MikroORM adapter ships with its own set of entities. If you'd like to override them, you can optionally pass them to the adapter."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="pages/api/auth/[...nextauth].ts"',title:'"pages/api/auth/[...nextauth].ts"'},'import config from "config/mikro-orm.ts"\nimport {\n  Cascade,\n  Collection,\n  Entity,\n  OneToMany,\n  PrimaryKey,\n  Property,\n  Unique,\n} from "@mikro-orm/core"\nimport { defaultEntities } from "@next-auth/mikro-orm-adapter"\n\nconst { Account, Session } = defaultEntities\n\n@Entity()\nexport class User implements defaultEntities.User {\n  @PrimaryKey()\n  id: string = randomUUID()\n\n  @Property({ nullable: true })\n  name?: string\n\n  @Property({ nullable: true })\n  @Unique()\n  email?: string\n\n  @Property({ type: "Date", nullable: true })\n  emailVerified: Date | null = null\n\n  @Property({ nullable: true })\n  image?: string\n\n  @OneToMany({\n    entity: () => Session,\n    mappedBy: (session) => session.user,\n    hidden: true,\n    orphanRemoval: true,\n    cascade: [Cascade.ALL],\n  })\n  sessions = new Collection<Session>(this)\n\n  @OneToMany({\n    entity: () => Account,\n    mappedBy: (account) => account.user,\n    hidden: true,\n    orphanRemoval: true,\n    cascade: [Cascade.ALL],\n  })\n  accounts = new Collection<Account>(this)\n\n  @Enum({ hidden: true })\n  role = "ADMIN"\n}\n\nexport default NextAuth({\n  adapter: MikroOrmAdapter(config, { entities: { User } })\n})\n')),(0,o.kt)("h3",{id:"including-the-default-entities-in-your-mikroorm-config"},"Including the default entities in your MikroORM config"),(0,o.kt)("p",null,"You may want to include the defaultEntities in your MikroORM configuration to include them in Migrations etc."),(0,o.kt)("p",null,'To achieve that include them in your "entities" array:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="config/mikro-orm.ts"',title:'"config/mikro-orm.ts"'},'import { Options } from "@mikro-orm/core";\nimport { defaultEntities } from "@next-auth/mikro-orm-adapter"\n\nconst config: Options = {\n  ...\n  entities: [VeryImportantEntity, ...Object.values(defaultEntities)],\n};\n\nexport default config;\n')))}f.isMDXComponent=!0}}]);