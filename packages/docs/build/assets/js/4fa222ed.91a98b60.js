"use strict";(self.webpackChunknext_auth_docs=self.webpackChunknext_auth_docs||[]).push([[565],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return h}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,s=e.originalType,l=e.parentName,d=r(e,["components","mdxType","originalType","parentName"]),u=p(n),h=i,m=u["".concat(l,".").concat(h)]||u[h]||c[h]||s;return n?a.createElement(m,o(o({ref:t},d),{},{components:n})):a.createElement(m,o({ref:t},d))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var s=n.length,o=new Array(s);o[0]=u;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r.mdxType="string"==typeof e?e:i,o[1]=r;for(var p=2;p<s;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},3660:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return r},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return d},default:function(){return u}});var a=n(7462),i=n(3366),s=(n(7294),n(3905)),o=["components"],r={id:"client",title:"Client API"},l=void 0,p={unversionedId:"getting-started/client",id:"getting-started/client",isDocsHomePage:!1,title:"Client API",description:"The NextAuth.js client library makes it easy to interact with sessions from React applications.",source:"@site/docs/getting-started/client.md",sourceDirName:"getting-started",slug:"/getting-started/client",permalink:"/getting-started/client",editUrl:"https://github.com/nextauthjs/docs/edit/main/docs/getting-started/client.md",tags:[],version:"current",lastUpdatedBy:"Bal\xe1zs Orb\xe1n",lastUpdatedAt:1643982356,formattedLastUpdatedAt:"2/4/2022",frontMatter:{id:"client",title:"Client API"},sidebar:"docs",previous:{title:"Getting Started",permalink:"/getting-started/example"},next:{title:"REST API",permalink:"/getting-started/rest-api"}},d=[{value:"Example Session Object",id:"example-session-object",children:[],level:4},{value:"useSession()",id:"usesession",children:[{value:"Example",id:"example",children:[],level:4},{value:"Require session",id:"require-session",children:[{value:"Example",id:"example-1",children:[],level:4}],level:3},{value:"Custom Client Session Handling",id:"custom-client-session-handling",children:[],level:3},{value:"NextAuth.js + React-Query",id:"nextauthjs--react-query",children:[],level:3}],level:2},{value:"getSession()",id:"getsession",children:[{value:"Client Side Example",id:"client-side-example",children:[],level:4},{value:"Server Side Example",id:"server-side-example",children:[],level:4}],level:2},{value:"getCsrfToken()",id:"getcsrftoken",children:[{value:"Client Side Example",id:"client-side-example-1",children:[],level:4},{value:"Server Side Example",id:"server-side-example-1",children:[],level:4}],level:2},{value:"getProviders()",id:"getproviders",children:[{value:"API Route",id:"api-route",children:[],level:4}],level:2},{value:"signIn()",id:"signin",children:[{value:"Redirects to sign in page when clicked",id:"redirects-to-sign-in-page-when-clicked",children:[],level:3},{value:"Starts OAuth sign-in flow when clicked",id:"starts-oauth-sign-in-flow-when-clicked",children:[],level:3},{value:"Starts Email sign-in flow when clicked",id:"starts-email-sign-in-flow-when-clicked",children:[],level:3},{value:"Specifying a <code>callbackUrl</code>",id:"specifying-a-callbackurl",children:[],level:3},{value:"Using the <code>redirect: false</code> option",id:"using-the-redirect-false-option",children:[],level:3},{value:"Additional parameters",id:"additional-parameters",children:[],level:3}],level:2},{value:"signOut()",id:"signout",children:[{value:"Specifying a <code>callbackUrl</code>",id:"specifying-a-callbackurl-1",children:[],level:3},{value:"Using the <code>redirect: false</code> option",id:"using-the-redirect-false-option-1",children:[],level:3}],level:2},{value:"SessionProvider",id:"sessionprovider",children:[{value:"Options",id:"options",children:[{value:"Refetch interval",id:"refetch-interval",children:[],level:4},{value:"Refetch On Window Focus",id:"refetch-on-window-focus",children:[],level:4}],level:3}],level:2}],c={toc:d};function u(e){var t=e.components,n=(0,i.Z)(e,o);return(0,s.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"The NextAuth.js client library makes it easy to interact with sessions from React applications."),(0,s.kt)("h4",{id:"example-session-object"},"Example Session Object"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},"{\n  user: {\n    name: string\n    email: string\n    image: string\n  },\n  expires: Date // This is the expiry of the session, not any of the tokens within the session\n}\n")),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"The session data returned to the client does not contain sensitive information such as the Session Token or OAuth tokens. It contains a minimal payload that includes enough data needed to display information on a page about the user who is signed in for presentation purposes (e.g name, email, image)."),(0,s.kt)("p",{parentName:"div"},"You can use the ",(0,s.kt)("a",{parentName:"p",href:"/configuration/callbacks#session-callback"},"session callback")," to customize the session object returned to the client if you need to return additional data in the session object."))),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"The ",(0,s.kt)("inlineCode",{parentName:"p"},"expires")," value is rotated, meaning whenever the session is retrieved from the ",(0,s.kt)("a",{parentName:"p",href:"/getting-started/rest-api"},"REST API"),", this value will be updated as well, to avoid session expiry."))),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"usesession"},"useSession()"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Client Side: ",(0,s.kt)("strong",{parentName:"li"},"Yes")),(0,s.kt)("li",{parentName:"ul"},"Server Side: No")),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"useSession()")," React Hook in the NextAuth.js client is the easiest way to check if someone is signed in."),(0,s.kt)("p",null,"Make sure that ",(0,s.kt)("a",{parentName:"p",href:"#sessionprovider"},(0,s.kt)("inlineCode",{parentName:"a"},"<SessionProvider>"))," is added to ",(0,s.kt)("inlineCode",{parentName:"p"},"pages/_app.js"),"."),(0,s.kt)("h4",{id:"example"},"Example"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},'import { useSession } from "next-auth/react"\n\nexport default function Component() {\n  const { data: session, status } = useSession()\n\n  if (status === "authenticated") {\n    return <p>Signed in as {session.user.email}</p>\n  }\n\n  return <a href="/api/auth/signin">Sign in</a>\n}\n')),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"useSession()")," returns an object containing two values: ",(0,s.kt)("inlineCode",{parentName:"p"},"data")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"status"),":"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"strong"},"data")),": This can be three values: ",(0,s.kt)("a",{parentName:"li",href:"https://github.com/nextauthjs/next-auth/blob/8ff4b260143458c5d8a16b80b11d1b93baa0690f/types/index.d.ts#L437-L444"},(0,s.kt)("inlineCode",{parentName:"a"},"Session"))," / ",(0,s.kt)("inlineCode",{parentName:"li"},"undefined")," / ",(0,s.kt)("inlineCode",{parentName:"li"},"null"),".",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"when the session hasn't been fetched yet, ",(0,s.kt)("inlineCode",{parentName:"li"},"data")," will ",(0,s.kt)("inlineCode",{parentName:"li"},"undefined")),(0,s.kt)("li",{parentName:"ul"},"in case it failed to retrieve the session, ",(0,s.kt)("inlineCode",{parentName:"li"},"data")," will be ",(0,s.kt)("inlineCode",{parentName:"li"},"null")),(0,s.kt)("li",{parentName:"ul"},"in case of success, ",(0,s.kt)("inlineCode",{parentName:"li"},"data")," will be ",(0,s.kt)("a",{parentName:"li",href:"https://github.com/nextauthjs/next-auth/blob/8ff4b260143458c5d8a16b80b11d1b93baa0690f/types/index.d.ts#L437-L444"},(0,s.kt)("inlineCode",{parentName:"a"},"Session")),"."))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"strong"},"status")),": enum mapping to three possible session states: ",(0,s.kt)("inlineCode",{parentName:"li"},'"loading" | "authenticated" | "unauthenticated"'))),(0,s.kt)("h3",{id:"require-session"},"Require session"),(0,s.kt)("p",null,"Due to the way how Next.js handles ",(0,s.kt)("inlineCode",{parentName:"p"},"getServerSideProps")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"getInitialProps"),", every protected page load has to make a server-side request to check if the session is valid and then generate the requested page (SSR). This increases server load, and if you are good with making the requests from the client, there is an alternative. You can use ",(0,s.kt)("inlineCode",{parentName:"p"},"useSession")," in a way that makes sure you always have a valid session. If after the initial loading state there was no session found, you can define the appropriate action to respond."),(0,s.kt)("p",null,"The default behavior is to redirect the user to the sign-in page, from where - after a successful login - they will be sent back to the page they started on. You can also define an ",(0,s.kt)("inlineCode",{parentName:"p"},"onFail()")," callback, if you would like to do something else:"),(0,s.kt)("h4",{id:"example-1"},"Example"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="pages/protected.jsx"',title:'"pages/protected.jsx"'},'import { useSession } from "next-auth/react"\n\nexport default function Admin() {\n  const { status } = useSession({\n    required: true,\n    onUnauthenticated() {\n      // The user is not authenticated, handle it here.\n    }\n  })\n\n  if (status === "loading") {\n    return "Loading or not authenticated..."\n  }\n\n  return "User is logged in"\n}\n')),(0,s.kt)("h3",{id:"custom-client-session-handling"},"Custom Client Session Handling"),(0,s.kt)("p",null,"Due to the way Next.js handles ",(0,s.kt)("inlineCode",{parentName:"p"},"getServerSideProps")," / ",(0,s.kt)("inlineCode",{parentName:"p"},"getInitialProps"),", every protected page load has to make a server-side request to check if the session is valid and then generate the requested page. This alternative solution allows for showing a loading state on the initial check and every page transition afterward will be client-side, without having to check with the server and regenerate pages."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="pages/admin.jsx"',title:'"pages/admin.jsx"'},'export default function AdminDashboard() {\n  const { data: session } = useSession()\n  // session is always non-null inside this page, all the way down the React tree.\n  return "Some super secret dashboard"\n}\n\nAdminDashboard.auth = true\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="pages/_app.jsx"',title:'"pages/_app.jsx"'},"export default function App({\n  Component,\n  pageProps: { session, ...pageProps },\n}) {\n  return (\n    <SessionProvider session={session}>\n      {Component.auth ? (\n        <Auth>\n          <Component {...pageProps} />\n        </Auth>\n      ) : (\n        <Component {...pageProps} />\n      )}\n    </SessionProvider>\n  )\n}\n\nfunction Auth({ children }) {\n  const { data: session, status } = useSession({required: true})\n  const isUser = !!session?.user\n\n  if (isUser) {\n    return children\n  }\n\n  // Session is being fetched, or no user.\n  // If no user, useEffect() will redirect.\n  return <div>Loading...</div>\n}\n")),(0,s.kt)("p",null,"It can be easily be extended/modified to support something like an options object for role based authentication on pages. An example:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="pages/admin.jsx"',title:'"pages/admin.jsx"'},'AdminDashboard.auth = {\n  role: "admin",\n  loading: <AdminLoadingSkeleton />,\n  unauthorized: "/login-with-different-user", // redirect to this url\n}\n')),(0,s.kt)("p",null,"Because of how ",(0,s.kt)("inlineCode",{parentName:"p"},"_app")," is written, it won't unnecessarily contact the ",(0,s.kt)("inlineCode",{parentName:"p"},"/api/auth/session")," endpoint for pages that do not require authentication."),(0,s.kt)("p",null,"More information can be found in the following ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/nextauthjs/next-auth/issues/1210"},"GitHub Issue"),"."),(0,s.kt)("h3",{id:"nextauthjs--react-query"},"NextAuth.js + React-Query"),(0,s.kt)("p",null,"There is also an alternative client-side API library based upon ",(0,s.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/react-query"},(0,s.kt)("inlineCode",{parentName:"a"},"react-query"))," available under ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/nextauthjs/react-query"},(0,s.kt)("inlineCode",{parentName:"a"},"nextauthjs/react-query")),"."),(0,s.kt)("p",null,"If you use ",(0,s.kt)("inlineCode",{parentName:"p"},"react-query")," in your project already, you can leverage it with NextAuth.js to handle the client-side session management for you as well. This replaces NextAuth.js's native ",(0,s.kt)("inlineCode",{parentName:"p"},"useSession")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"SessionProvider")," from ",(0,s.kt)("inlineCode",{parentName:"p"},"next-auth/react"),"."),(0,s.kt)("p",null,"See repository ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/nextauthjs/react-query"},(0,s.kt)("inlineCode",{parentName:"a"},"README"))," for more details."),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"getsession"},"getSession()"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Client Side: ",(0,s.kt)("strong",{parentName:"li"},"Yes")),(0,s.kt)("li",{parentName:"ul"},"Server Side: ",(0,s.kt)("strong",{parentName:"li"},"Yes"))),(0,s.kt)("p",null,"NextAuth.js provides a ",(0,s.kt)("inlineCode",{parentName:"p"},"getSession()")," method which can be called client or server side to return a session."),(0,s.kt)("p",null,"It calls ",(0,s.kt)("inlineCode",{parentName:"p"},"/api/auth/session")," and returns a promise with a session object, or null if no session exists."),(0,s.kt)("h4",{id:"client-side-example"},"Client Side Example"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"async function myFunction() {\n  const session = await getSession()\n  /* ... */\n}\n")),(0,s.kt)("h4",{id:"server-side-example"},"Server Side Example"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'import { getSession } from "next-auth/react"\n\nexport default async (req, res) => {\n  const session = await getSession({ req })\n  /* ... */\n  res.end()\n}\n')),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"When calling ",(0,s.kt)("inlineCode",{parentName:"p"},"getSession()")," server side, you need to pass ",(0,s.kt)("inlineCode",{parentName:"p"},"{req}")," or ",(0,s.kt)("inlineCode",{parentName:"p"},"context")," object."))),(0,s.kt)("p",null,"The tutorial ",(0,s.kt)("a",{parentName:"p",href:"/tutorials/securing-pages-and-api-routes"},"securing pages and API routes")," shows how to use ",(0,s.kt)("inlineCode",{parentName:"p"},"getSession()")," in server side calls."),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"getcsrftoken"},"getCsrfToken()"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Client Side: ",(0,s.kt)("strong",{parentName:"li"},"Yes")),(0,s.kt)("li",{parentName:"ul"},"Server Side: ",(0,s.kt)("strong",{parentName:"li"},"Yes"))),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"getCsrfToken()")," method returns the current Cross Site Request Forgery Token (CSRF Token) required to make POST requests (e.g. for signing in and signing out)."),(0,s.kt)("p",null,"You likely only need to use this if you are not using the built-in ",(0,s.kt)("inlineCode",{parentName:"p"},"signIn()")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"signOut()")," methods."),(0,s.kt)("h4",{id:"client-side-example-1"},"Client Side Example"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"async function myFunction() {\n  const csrfToken = await getCsrfToken()\n  /* ... */\n}\n")),(0,s.kt)("h4",{id:"server-side-example-1"},"Server Side Example"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'import { getCsrfToken } from "next-auth/react"\n\nexport default async (req, res) => {\n  const csrfToken = await getCsrfToken({ req })\n  /* ... */\n  res.end()\n}\n')),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"getproviders"},"getProviders()"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Client Side: ",(0,s.kt)("strong",{parentName:"li"},"Yes")),(0,s.kt)("li",{parentName:"ul"},"Server Side: ",(0,s.kt)("strong",{parentName:"li"},"Yes"))),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"getProviders()")," method returns the list of providers currently configured for sign in."),(0,s.kt)("p",null,"It calls ",(0,s.kt)("inlineCode",{parentName:"p"},"/api/auth/providers")," and returns a list of the currently configured authentication providers."),(0,s.kt)("p",null,"It can be useful if you are creating a dynamic custom sign in page."),(0,s.kt)("hr",null),(0,s.kt)("h4",{id:"api-route"},"API Route"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="pages/api/example.js"',title:'"pages/api/example.js"'},'import { getProviders } from "next-auth/react"\n\nexport default async (req, res) => {\n  const providers = await getProviders()\n  console.log("Providers", providers)\n  res.end()\n}\n')),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"Unlike ",(0,s.kt)("inlineCode",{parentName:"p"},"getSession()")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"getCsrfToken()"),", when calling ",(0,s.kt)("inlineCode",{parentName:"p"},"getProviders()")," server side, you don't need to pass anything, just as calling it client side."))),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"signin"},"signIn()"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Client Side: ",(0,s.kt)("strong",{parentName:"li"},"Yes")),(0,s.kt)("li",{parentName:"ul"},"Server Side: No")),(0,s.kt)("p",null,"Using the ",(0,s.kt)("inlineCode",{parentName:"p"},"signIn()")," method ensures the user ends back on the page they started on after completing a sign in flow. It will also handle CSRF Tokens for you automatically when signing in with email."),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"signIn()")," method can be called from the client in different ways, as shown below."),(0,s.kt)("h3",{id:"redirects-to-sign-in-page-when-clicked"},"Redirects to sign in page when clicked"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'import { signIn } from "next-auth/react"\n\nexport default () => <button onClick={() => signIn()}>Sign in</button>\n')),(0,s.kt)("h3",{id:"starts-oauth-sign-in-flow-when-clicked"},"Starts OAuth sign-in flow when clicked"),(0,s.kt)("p",null,"By default, when calling the ",(0,s.kt)("inlineCode",{parentName:"p"},"signIn()")," method with no arguments, you will be redirected to the NextAuth.js sign-in page. If you want to skip that and get redirected to your provider's page immediately, call the ",(0,s.kt)("inlineCode",{parentName:"p"},"signIn()")," method with the provider's ",(0,s.kt)("inlineCode",{parentName:"p"},"id"),". "),(0,s.kt)("p",null,"For example to sign in with Google:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'import { signIn } from "next-auth/react"\n\nexport default () => (\n  <button onClick={() => signIn("google")}>Sign in with Google</button>\n)\n')),(0,s.kt)("h3",{id:"starts-email-sign-in-flow-when-clicked"},"Starts Email sign-in flow when clicked"),(0,s.kt)("p",null,"When using it with the email flow, pass the target ",(0,s.kt)("inlineCode",{parentName:"p"},"email")," as an option."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'import { signIn } from "next-auth/react"\n\nexport default ({ email }) => (\n  <button onClick={() => signIn("email", { email })}>Sign in with Email</button>\n)\n')),(0,s.kt)("h3",{id:"specifying-a-callbackurl"},"Specifying a ",(0,s.kt)("inlineCode",{parentName:"h3"},"callbackUrl")),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"callbackUrl")," specifies to which URL the user will be redirected after signing in. It defaults to the current URL of a user."),(0,s.kt)("p",null,"You can specify a different ",(0,s.kt)("inlineCode",{parentName:"p"},"callbackUrl")," by specifying it as the second argument of ",(0,s.kt)("inlineCode",{parentName:"p"},"signIn()"),". This works for all providers."),(0,s.kt)("p",null,"e.g."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"signIn(null, { callbackUrl: 'http://localhost:3000/foo' })")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"signIn('google', { callbackUrl: 'http://localhost:3000/foo' })")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"signIn('email', { email, callbackUrl: 'http://localhost:3000/foo' })"))),(0,s.kt)("p",null,"The URL must be considered valid by the ",(0,s.kt)("a",{parentName:"p",href:"/configuration/callbacks#redirect-callback"},"redirect callback handler"),". By default it requires the URL to be an absolute URL at the same host name, or else it will redirect to the homepage. You can define your own ",(0,s.kt)("a",{parentName:"p",href:"/configuration/callbacks#redirect-callback"},"redirect callback")," to allow other URLs, including supporting relative URLs."),(0,s.kt)("h3",{id:"using-the-redirect-false-option"},"Using the ",(0,s.kt)("inlineCode",{parentName:"h3"},"redirect: false")," option"),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"The redirect option is only available for ",(0,s.kt)("inlineCode",{parentName:"p"},"credentials")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"email")," providers."))),(0,s.kt)("p",null,"In some cases, you might want to deal with the sign in response on the same page and disable the default redirection. For example, if an error occurs (like wrong credentials given by the user), you might want to handle the error on the same page. For that, you can pass ",(0,s.kt)("inlineCode",{parentName:"p"},"redirect: false")," in the second parameter object."),(0,s.kt)("p",null,"e.g."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"signIn('credentials', { redirect: false, password: 'password' })")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"signIn('email', { redirect: false, email: 'bill@fillmurray.com' })"))),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"signIn")," will then return a Promise, that resolves to the following:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},"{\n  /**\n   * Will be different error codes,\n   * depending on the type of error.\n   */\n  error: string | undefined\n  /**\n   * HTTP status code,\n   * hints the kind of error that happened.\n   */\n  status: number\n  /**\n   * `true` if the signin was successful\n   */\n  ok: boolean\n  /**\n   * `null` if there was an error,\n   * otherwise the url the user\n   * should have been redirected to.\n   */\n  url: string | null\n}\n")),(0,s.kt)("h3",{id:"additional-parameters"},"Additional parameters"),(0,s.kt)("p",null,"It is also possible to pass additional parameters to the ",(0,s.kt)("inlineCode",{parentName:"p"},"/authorize")," endpoint through the third argument of ",(0,s.kt)("inlineCode",{parentName:"p"},"signIn()"),"."),(0,s.kt)("p",null,"See the ",(0,s.kt)("a",{parentName:"p",href:"https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest"},"Authorization Request OIDC spec")," for some ideas. (These are not the only possible ones, all parameters will be forwarded)"),(0,s.kt)("p",null,"e.g."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},'signIn("identity-server4", null, { prompt: "login" })')," ",(0,s.kt)("em",{parentName:"li"},"always ask the user to re-authenticate")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},'signIn("auth0", null, { login_hint: "info@example.com" })')," ",(0,s.kt)("em",{parentName:"li"},"hints the e-mail address to the provider"))),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"You can also set these parameters through ",(0,s.kt)("a",{parentName:"p",href:"/configuration/providers/oauth#options"},(0,s.kt)("inlineCode",{parentName:"a"},"provider.authorizationParams")),"."))),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"The following parameters are always overridden server-side: ",(0,s.kt)("inlineCode",{parentName:"p"},"redirect_uri"),", ",(0,s.kt)("inlineCode",{parentName:"p"},"state")))),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"signout"},"signOut()"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Client Side: ",(0,s.kt)("strong",{parentName:"li"},"Yes")),(0,s.kt)("li",{parentName:"ul"},"Server Side: No")),(0,s.kt)("p",null,"In order to logout, use the ",(0,s.kt)("inlineCode",{parentName:"p"},"signOut()")," method to ensure the user ends back on the page they started on after completing the sign out flow. It also handles CSRF tokens for you automatically."),(0,s.kt)("p",null,"It reloads the page in the browser when complete."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'import { signOut } from "next-auth/react"\n\nexport default () => <button onClick={() => signOut()}>Sign out</button>\n')),(0,s.kt)("h3",{id:"specifying-a-callbackurl-1"},"Specifying a ",(0,s.kt)("inlineCode",{parentName:"h3"},"callbackUrl")),(0,s.kt)("p",null,"As with the ",(0,s.kt)("inlineCode",{parentName:"p"},"signIn()")," function, you can specify a ",(0,s.kt)("inlineCode",{parentName:"p"},"callbackUrl")," parameter by passing it as an option."),(0,s.kt)("p",null,"e.g. ",(0,s.kt)("inlineCode",{parentName:"p"},"signOut({ callbackUrl: 'http://localhost:3000/foo' })")),(0,s.kt)("p",null,"The URL must be considered valid by the ",(0,s.kt)("a",{parentName:"p",href:"/configuration/callbacks#redirect-callback"},"redirect callback handler"),". By default this means it must be an absolute URL at the same host name (or else it will default to the homepage); you can define your own custom ",(0,s.kt)("a",{parentName:"p",href:"/configuration/callbacks#redirect-callback"},"redirect callback")," to allow other URLs, including supporting relative URLs."),(0,s.kt)("h3",{id:"using-the-redirect-false-option-1"},"Using the ",(0,s.kt)("inlineCode",{parentName:"h3"},"redirect: false")," option"),(0,s.kt)("p",null,"If you pass ",(0,s.kt)("inlineCode",{parentName:"p"},"redirect: false")," to ",(0,s.kt)("inlineCode",{parentName:"p"},"signOut"),", the page will not reload. The session will be deleted, and the ",(0,s.kt)("inlineCode",{parentName:"p"},"useSession")," hook is notified, so any indication about the user will be shown as logged out automatically. It can give a very nice experience for the user."),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"If you need to redirect to another page but you want to avoid a page reload, you can try:\n",(0,s.kt)("inlineCode",{parentName:"p"},'const data = await signOut({redirect: false, callbackUrl: "/foo"})'),"\nwhere ",(0,s.kt)("inlineCode",{parentName:"p"},"data.url")," is the validated URL you can redirect the user to without any flicker by using Next.js's ",(0,s.kt)("inlineCode",{parentName:"p"},"useRouter().push(data.url)")))),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"sessionprovider"},"SessionProvider"),(0,s.kt)("p",null,"Using the supplied ",(0,s.kt)("inlineCode",{parentName:"p"},"<SessionProvider>")," allows instances of ",(0,s.kt)("inlineCode",{parentName:"p"},"useSession()")," to share the session object across components, by using ",(0,s.kt)("a",{parentName:"p",href:"https://reactjs.org/docs/context.html"},"React Context")," under the hood. It also takes care of keeping the session updated and synced between tabs/windows."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="pages/_app.js"',title:'"pages/_app.js"'},'import { SessionProvider } from "next-auth/react"\n\nexport default function App({\n  Component,\n  pageProps: { session, ...pageProps },\n}) {\n  return (\n    <SessionProvider session={session}>\n      <Component {...pageProps} />\n    </SessionProvider>\n  )\n}\n')),(0,s.kt)("p",null,"If you pass the ",(0,s.kt)("inlineCode",{parentName:"p"},"session")," page prop to the ",(0,s.kt)("inlineCode",{parentName:"p"},"<SessionProvider>")," \u2013 as in the example above \u2013 you can avoid checking the session twice on pages that support both server and client side rendering."),(0,s.kt)("p",null,"This only works on pages where you provide the correct ",(0,s.kt)("inlineCode",{parentName:"p"},"pageProps"),", however. This is normally done in ",(0,s.kt)("inlineCode",{parentName:"p"},"getInitialProps")," or ",(0,s.kt)("inlineCode",{parentName:"p"},"getServerSideProps")," on an individual page basis like so:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="pages/index.js"',title:'"pages/index.js"'},'import { getSession } from "next-auth/react"\n\n...\n\nexport async function getServerSideProps(ctx) {\n  return {\n    props: {\n      session: await getSession(ctx)\n    }\n  }\n}\n')),(0,s.kt)("p",null,"If every one of your pages needs to be protected, you can do this in ",(0,s.kt)("inlineCode",{parentName:"p"},"getInitialProps")," in ",(0,s.kt)("inlineCode",{parentName:"p"},"_app"),", otherwise you can do it on a page-by-page basis. Alternatively, you can do per page authentication checks client side, instead of having each authentication check be blocking (SSR) by using the method described below in ",(0,s.kt)("a",{parentName:"p",href:"#custom-client-session-handling"},"alternative client session handling"),"."),(0,s.kt)("h3",{id:"options"},"Options"),(0,s.kt)("p",null,"The session state is automatically synchronized across all open tabs/windows and they are all updated whenever they gain or lose focus or the state changes (e.g. a user signs in or out) when ",(0,s.kt)("inlineCode",{parentName:"p"},"refetchOnWindowFocus")," is ",(0,s.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,s.kt)("p",null,"If you have session expiry times of 30 days (the default) or more then you probably don't need to change any of the default options in the Provider. If you need to, you can trigger an update of the session object across all tabs/windows by calling ",(0,s.kt)("inlineCode",{parentName:"p"},"getSession()")," from a client side function."),(0,s.kt)("p",null,"However, if you need to customize the session behavior and/or are using short session expiry times, you can pass options to the provider to customize the behavior of the ",(0,s.kt)("inlineCode",{parentName:"p"},"useSession()")," hook."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="pages/_app.js"',title:'"pages/_app.js"'},'import { SessionProvider } from "next-auth/react"\n\nexport default function App({\n  Component,\n  pageProps: { session, ...pageProps },\n}) {\n  return (\n    <SessionProvider\n      session={session}\n      // Re-fetch session every 5 minutes\n      refetchInterval={5 * 60}\n      // Re-fetches session when window is focused\n      refetchOnWindowFocus={true}\n    >\n      <Component {...pageProps} />\n    </SessionProvider>\n  )\n}\n')),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},(0,s.kt)("strong",{parentName:"p"},"These options have no effect on clients that are not signed in.")),(0,s.kt)("p",{parentName:"div"},"Every tab/window maintains its own copy of the local session state; the session is not stored in shared storage like localStorage or sessionStorage. Any update in one tab/window triggers a message to other tabs/windows to update their own session state."),(0,s.kt)("p",{parentName:"div"},"Using low values for ",(0,s.kt)("inlineCode",{parentName:"p"},"refetchInterval")," will increase network traffic and load on authenticated clients and may impact hosting costs and performance."))),(0,s.kt)("h4",{id:"refetch-interval"},"Refetch interval"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"refetchInterval")," option can be used to contact the server to avoid a session expiring."),(0,s.kt)("p",null,"When ",(0,s.kt)("inlineCode",{parentName:"p"},"refetchInterval")," is set to ",(0,s.kt)("inlineCode",{parentName:"p"},"0")," (the default) there will be no session polling."),(0,s.kt)("p",null,"If set to any value other than zero, it specifies in seconds how often the client should contact the server to update the session state. If the session state has expired when it is triggered, all open tabs/windows will be updated to reflect this."),(0,s.kt)("p",null,"The value for ",(0,s.kt)("inlineCode",{parentName:"p"},"refetchInterval")," should always be lower than the value of the session ",(0,s.kt)("inlineCode",{parentName:"p"},"maxAge")," ",(0,s.kt)("a",{parentName:"p",href:"/configuration/options#session"},"session option"),"."),(0,s.kt)("h4",{id:"refetch-on-window-focus"},"Refetch On Window Focus"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"refetchOnWindowFocus")," option can be used to control whether it automatically updates the session state when you switch a focus on tabs/windows."),(0,s.kt)("p",null,"When ",(0,s.kt)("inlineCode",{parentName:"p"},"refetchOnWindowFocus")," is set to ",(0,s.kt)("inlineCode",{parentName:"p"},"true")," (the default) tabs/windows will be updated and initialize the components' state when they gain or lose focus."),(0,s.kt)("p",null,"However, if it was set to ",(0,s.kt)("inlineCode",{parentName:"p"},"false"),", it stops re-fetching the session and the components will stay as it is."),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"See ",(0,s.kt)("a",{parentName:"p",href:"https://nextjs.org/docs/advanced-features/custom-app"},(0,s.kt)("strong",{parentName:"a"},"the Next.js documentation"))," for more information on ",(0,s.kt)("strong",{parentName:"p"},"_","app.js")," in Next.js applications."))))}u.isMDXComponent=!0}}]);