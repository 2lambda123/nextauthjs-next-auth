"use strict";(self.webpackChunknext_auth_docs=self.webpackChunknext_auth_docs||[]).push([[1692],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=p(n),m=i,k=u["".concat(s,".").concat(m)]||u[m]||c[m]||o;return n?a.createElement(k,r(r({ref:t},d),{},{components:n})):a.createElement(k,r({ref:t},d))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,r[1]=l;for(var p=2;p<o;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},6222:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return d},default:function(){return u}});var a=n(7462),i=n(3366),o=(n(7294),n(3905)),r=["components"],l={id:"options",title:"Options"},s=void 0,p={unversionedId:"configuration/options",id:"configuration/options",isDocsHomePage:!1,title:"Options",description:"Environment Variables",source:"@site/docs/configuration/options.md",sourceDirName:"configuration",slug:"/configuration/options",permalink:"/configuration/options",editUrl:"https://github.com/nextauthjs/docs/edit/main/docs/configuration/options.md",tags:[],version:"current",lastUpdatedBy:"Bal\xe1zs Orb\xe1n",lastUpdatedAt:1643982356,formattedLastUpdatedAt:"2/4/2022",frontMatter:{id:"options",title:"Options"},sidebar:"docs",previous:{title:"Initialization",permalink:"/configuration/initialization"},next:{title:"OAuth",permalink:"/configuration/providers/oauth"}},d=[{value:"Environment Variables",id:"environment-variables",children:[{value:"NEXTAUTH_URL",id:"nextauth_url",children:[],level:3},{value:"NEXTAUTH_SECRET",id:"nextauth_secret",children:[],level:3},{value:"NEXTAUTH_URL_INTERNAL",id:"nextauth_url_internal",children:[],level:3}],level:2},{value:"Options",id:"options",children:[{value:"providers",id:"providers",children:[{value:"Description",id:"description",children:[],level:4}],level:3},{value:"secret",id:"secret",children:[{value:"Description",id:"description-1",children:[],level:4}],level:3},{value:"session",id:"session",children:[{value:"Description",id:"description-2",children:[],level:4}],level:3},{value:"jwt",id:"jwt",children:[{value:"Description",id:"description-3",children:[],level:4},{value:"JSON Web Token Options",id:"json-web-token-options",children:[],level:4},{value:"JWT Helper",id:"jwt-helper",children:[],level:4}],level:3},{value:"pages",id:"pages",children:[{value:"Description",id:"description-4",children:[],level:4}],level:3},{value:"callbacks",id:"callbacks",children:[{value:"Description",id:"description-5",children:[],level:4}],level:3},{value:"events",id:"events",children:[{value:"Description",id:"description-6",children:[],level:4}],level:3},{value:"adapter",id:"adapter",children:[{value:"Description",id:"description-7",children:[],level:4}],level:3},{value:"debug",id:"debug",children:[{value:"Description",id:"description-8",children:[],level:4}],level:3},{value:"logger",id:"logger",children:[{value:"Description",id:"description-9",children:[],level:4}],level:3},{value:"theme",id:"theme",children:[{value:"Description",id:"description-10",children:[],level:4}],level:3}],level:2},{value:"Advanced Options",id:"advanced-options",children:[{value:"useSecureCookies",id:"usesecurecookies",children:[{value:"Description",id:"description-11",children:[],level:4}],level:3},{value:"cookies",id:"cookies",children:[{value:"Description",id:"description-12",children:[],level:4},{value:"Example",id:"example",children:[],level:4}],level:3}],level:2}],c={toc:d};function u(e){var t=e.components,n=(0,i.Z)(e,r);return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"environment-variables"},"Environment Variables"),(0,o.kt)("h3",{id:"nextauth_url"},"NEXTAUTH_URL"),(0,o.kt)("p",null,"When deploying to production, set the ",(0,o.kt)("inlineCode",{parentName:"p"},"NEXTAUTH_URL")," environment variable to the canonical URL of your site."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"NEXTAUTH_URL=https://example.com\n")),(0,o.kt)("p",null,"If your Next.js application uses a custom base path, specify the route to the API endpoint in full."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"e.g. ",(0,o.kt)("inlineCode",{parentName:"em"},"NEXTAUTH_URL=https://example.com/custom-route/api/auth"))),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"We automatically detect when you deploy to ",(0,o.kt)("a",{parentName:"p",href:"https://vercel.com"},"Vercel")," so you don't have to define this variable."))),(0,o.kt)("h3",{id:"nextauth_secret"},"NEXTAUTH_SECRET"),(0,o.kt)("p",null,"Used to encrypt the NextAuth.js JWT, and to hash ",(0,o.kt)("a",{parentName:"p",href:"/adapters/models#verification-token"},"email verification tokens"),". This is the default value for the ",(0,o.kt)("a",{parentName:"p",href:"/configuration/options#secret"},(0,o.kt)("inlineCode",{parentName:"a"},"secret"))," option. The ",(0,o.kt)("inlineCode",{parentName:"p"},"secret")," option might be removed in the future in favor of this."),(0,o.kt)("p",null,"If you are using ",(0,o.kt)("a",{parentName:"p",href:"/configuration/nextjs#prerequisites"},"Middleware")," this environment variables must be set."),(0,o.kt)("h3",{id:"nextauth_url_internal"},"NEXTAUTH_URL_INTERNAL"),(0,o.kt)("p",null,"If provided, server-side calls will use this instead of ",(0,o.kt)("inlineCode",{parentName:"p"},"NEXTAUTH_URL"),". Useful in environments when the server doesn't have access to the canonical URL of your site. Defaults to ",(0,o.kt)("inlineCode",{parentName:"p"},"NEXTAUTH_URL"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"NEXTAUTH_URL_INTERNAL=http://10.240.8.16\n")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"options"},"Options"),(0,o.kt)("p",null,"Options are passed to NextAuth.js when initializing it in an API route."),(0,o.kt)("h3",{id:"providers"},"providers"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"[]")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"Yes"))),(0,o.kt)("h4",{id:"description"},"Description"),(0,o.kt)("p",null,"An array of authentication providers for signing in (e.g. Google, Facebook, Twitter, GitHub, Email, etc) in any order. This can be one of the built-in providers or an object with a custom provider."),(0,o.kt)("p",null,"See the ",(0,o.kt)("a",{parentName:"p",href:"/configuration/providers/oauth"},"providers documentation")," for a list of supported providers and how to use them."),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"secret"},"secret"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"string")," (",(0,o.kt)("em",{parentName:"li"},'SHA hash of the "options" object'),") in development, no default in production."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"Yes, in production!"))),(0,o.kt)("h4",{id:"description-1"},"Description"),(0,o.kt)("p",null,"A random string is used to hash tokens, sign/encrypt cookies and generate cryptographic keys."),(0,o.kt)("p",null,"If you set ",(0,o.kt)("a",{parentName:"p",href:"#nextauth_secret"},(0,o.kt)("inlineCode",{parentName:"a"},"NEXTAUTH_SECRET"))," as an environment variable, you don't have to define this option."),(0,o.kt)("p",null,"If no value specified specified in development (and there is no ",(0,o.kt)("inlineCode",{parentName:"p"},"NEXTAUTH_SECRET")," variable either), it uses a hash for all configuration options, including OAuth Client ID / Secrets for entropy."),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Not providing any ",(0,o.kt)("inlineCode",{parentName:"p"},"secret")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"NEXTAUTH_SECRET")," will throw ",(0,o.kt)("a",{parentName:"p",href:"/errors#no_secret"},"an error")," in production."))),(0,o.kt)("p",null,"You can quickly create a good value on the command line via this ",(0,o.kt)("inlineCode",{parentName:"p"},"openssl")," command."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ openssl rand -base64 32\n")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If you rely on the default secret generation in development, you might notice JWT decryption errors, since the secret changes whenever you change your configuration. Defining an explicit secret will make this problem go away. We will likely make this option mandatory, even in development, in the future."))),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"session"},"session"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"object")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"No"))),(0,o.kt)("h4",{id:"description-2"},"Description"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"session")," object and all properties on it are optional."),(0,o.kt)("p",null,"Default values for this option are shown below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'session: {\n  // Choose how you want to save the user session.\n  // The default is `"jwt"`, an encrypted JWT (JWE) in the session cookie.\n  // If you use an `adapter` however, we default it to `"database"` instead.\n  // You can still force a JWT session by explicitly defining `"jwt"`.\n  // When using `"database"`, the session cookie will only contain a `sessionToken` value,\n  // which is used to look up the session in the database.\n  strategy: "database",\n\n  // Seconds - How long until an idle session expires and is no longer valid.\n  maxAge: 30 * 24 * 60 * 60, // 30 days\n\n  // Seconds - Throttle how frequently to write to database to extend a session.\n  // Use it to limit write operations. Set to 0 to always update the database.\n  // Note: This option is ignored if using JSON Web Tokens\n  updateAge: 24 * 60 * 60, // 24 hours\n}\n')),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"jwt"},"jwt"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"object")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"No"))),(0,o.kt)("h4",{id:"description-3"},"Description"),(0,o.kt)("p",null,"JSON Web Tokens can be used for session tokens if enabled with ",(0,o.kt)("inlineCode",{parentName:"p"},'session: { strategy: "jwt" }')," option. JSON Web Tokens are enabled by default if you have not specified an adapter."),(0,o.kt)("p",null,"JSON Web Tokens are encrypted (JWE) by default. We recommend you keep this behaviour, but you can override this using the ",(0,o.kt)("inlineCode",{parentName:"p"},"encode")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"decode")," methods."),(0,o.kt)("h4",{id:"json-web-token-options"},"JSON Web Token Options"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"jwt: {\n  // The maximum age of the NextAuth.js issued JWT in seconds.\n  // Defaults to `session.maxAge`.\n  maxAge: 60 * 60 * 24 * 30,\n  // You can define your own encode/decode functions for signing and encryption\n  // if you want to override the default behavior.\n  async encode({ secret, token, maxAge }) {},\n  async decode({ secret, token }) {},\n}\n")),(0,o.kt)("p",null,"An example JSON Web Token contains a payload like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"{\n  name: 'Iain Collins',\n  email: 'me@iaincollins.com',\n  picture: 'https://example.com/image.jpg',\n  iat: 1594601838,\n  exp: 1597193838\n}\n")),(0,o.kt)("h4",{id:"jwt-helper"},"JWT Helper"),(0,o.kt)("p",null,"You can use the built-in ",(0,o.kt)("inlineCode",{parentName:"p"},"getToken()")," helper method to verify and decrypt the token, like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'import { getToken } from "next-auth/jwt"\n\nconst secret = process.env.NEXTAUTH_SECRET\n\nexport default async function handler(req, res) {\n  // if using `NEXTAUTG_SECRET` env variable, we detect it, and you won\'t actually need to `secret`\n  // const token = await getToken({ req })\n  const token = await getToken({ req, secret })\n  console.log("JSON Web Token", token)\n  res.end()\n}\n')),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"For convenience, this helper function is also able to read and decode tokens passed from the ",(0,o.kt)("inlineCode",{parentName:"em"},"Authorization: 'Bearer token'")," HTTP header.")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Required")),(0,o.kt)("p",null,"The getToken() helper requires the following options:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"req")," - (object) Request object"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"secret")," - (string) JWT Secret. Use ",(0,o.kt)("inlineCode",{parentName:"li"},"NEXTAUTH_SECRET")," instead.")),(0,o.kt)("p",null,"You must also pass ",(0,o.kt)("em",{parentName:"p"},"any options configured on the ",(0,o.kt)("inlineCode",{parentName:"em"},"jwt")," option")," to the helper."),(0,o.kt)("p",null,"e.g. Including custom session ",(0,o.kt)("inlineCode",{parentName:"p"},"maxAge")," and custom signing and/or encryption keys or options"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Optional")),(0,o.kt)("p",null,"It also supports the following options:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"secureCookie")," - (boolean) Use secure prefixed cookie name"),(0,o.kt)("p",{parentName:"li"},"By default, the helper function will attempt to determine if it should use the secure prefixed cookie (e.g. ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," in production and ",(0,o.kt)("inlineCode",{parentName:"p"},"false")," in development, unless NEXTAUTH_URL contains an HTTPS URL).")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"cookieName")," - (string) Session token cookie name"),(0,o.kt)("p",{parentName:"li"},"The ",(0,o.kt)("inlineCode",{parentName:"p"},"secureCookie")," option is ignored if ",(0,o.kt)("inlineCode",{parentName:"p"},"cookieName")," is explicitly specified.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"raw")," - (boolean) Get raw token (not decoded)"),(0,o.kt)("p",{parentName:"li"},"If set to ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," returns the raw token without decrypting or verifying it."))),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The JWT is stored in the Session Token cookie, the same cookie used for tokens with database sessions."))),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"pages"},"pages"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"{}")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"No"))),(0,o.kt)("h4",{id:"description-4"},"Description"),(0,o.kt)("p",null,"Specify URLs to be used if you want to create custom sign in, sign out and error pages."),(0,o.kt)("p",null,"Pages specified will override the corresponding built-in page."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"For example:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"pages: {\n  signIn: '/auth/signin',\n  signOut: '/auth/signout',\n  error: '/auth/error', // Error code passed in query string as ?error=\n  verifyRequest: '/auth/verify-request', // (used for check email message)\n  newUser: '/auth/new-user' // New users will be directed here on first sign in (leave the property out if not of interest)\n}\n")),(0,o.kt)("p",null,"See the documentation for the ",(0,o.kt)("a",{parentName:"p",href:"/configuration/pages"},"pages option")," for more information."),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"callbacks"},"callbacks"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"object")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"No"))),(0,o.kt)("h4",{id:"description-5"},"Description"),(0,o.kt)("p",null,"Callbacks are asynchronous functions you can use to control what happens when an action is performed."),(0,o.kt)("p",null,"Callbacks are extremely powerful, especially in scenarios involving JSON Web Tokens as they allow you to implement access controls without a database and to integrate with external databases or APIs."),(0,o.kt)("p",null,"You can specify a handler for any of the callbacks below."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"callbacks: {\n  async signIn({ user, account, profile, email, credentials }) {\n    return true\n  },\n  async redirect({ url, baseUrl }) {\n    return baseUrl\n  },\n  async session({ session, token, user }) {\n    return session\n  },\n  async jwt({ token, user, account, profile, isNewUser }) {\n    return token\n  }\n}\n")),(0,o.kt)("p",null,"See the ",(0,o.kt)("a",{parentName:"p",href:"/configuration/callbacks"},"callbacks documentation")," for more information on how to use the callback functions."),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"events"},"events"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"object")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"No"))),(0,o.kt)("h4",{id:"description-6"},"Description"),(0,o.kt)("p",null,"Events are asynchronous functions that do not return a response, they are useful for audit logging."),(0,o.kt)("p",null,"You can specify a handler for any of these events below - e.g. for debugging or to create an audit log."),(0,o.kt)("p",null,"The content of the message object varies depending on the flow (e.g. OAuth or Email authentication flow, JWT or database sessions, etc). See the ",(0,o.kt)("a",{parentName:"p",href:"/configuration/events"},"events documentation")," for more information on the form of each message object and how to use the events functions."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"events: {\n  async signIn(message) { /* on successful sign in */ },\n  async signOut(message) { /* on signout */ },\n  async createUser(message) { /* user created */ },\n  async updateUser(message) { /* user updated - e.g. their email was verified */ },\n  async linkAccount(message) { /* account (e.g. Twitter) linked to a user */ },\n  async session(message) { /* session is active */ },\n  async error(message) { /* error in authentication flow */ }\n}\n")),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"adapter"},"adapter"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": none"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"No"))),(0,o.kt)("h4",{id:"description-7"},"Description"),(0,o.kt)("p",null,"By default NextAuth.js does not include an adapter any longer. If you would like to persist user / account data, please install one of the many available adapters. More information can be found in the ",(0,o.kt)("a",{parentName:"p",href:"/adapters/overview"},"adapter documentation"),"."),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"debug"},"debug"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"false")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"No"))),(0,o.kt)("h4",{id:"description-8"},"Description"),(0,o.kt)("p",null,"Set debug to ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," to enable debug messages for authentication and database operations."),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"logger"},"logger"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"console")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"No"))),(0,o.kt)("h4",{id:"description-9"},"Description"),(0,o.kt)("p",null,"Override any of the logger levels (",(0,o.kt)("inlineCode",{parentName:"p"},"undefined")," levels will use the built-in logger), and intercept logs in NextAuth. You can use this to send NextAuth logs to a third-party logging service."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"code")," parameter for ",(0,o.kt)("inlineCode",{parentName:"p"},"error")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"warn")," are explained in the ",(0,o.kt)("a",{parentName:"p",href:"/warnings"},"Warnings")," and ",(0,o.kt)("a",{parentName:"p",href:"/errors"},"Errors")," pages respectively."),(0,o.kt)("p",null,"Example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="/pages/api/auth/[...nextauth].js"',title:'"/pages/api/auth/[...nextauth].js"'},'import log from "logging-service"\n\nexport default NextAuth({\n  ...\n  logger: {\n    error(code, metadata) {\n      log.error(code, metadata)\n    },\n    warn(code) {\n      log.warn(code)\n    },\n    debug(code, metadata) {\n      log.debug(code, metadata)\n    }\n  }\n  ...\n})\n')),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If the ",(0,o.kt)("inlineCode",{parentName:"p"},"debug")," level is defined by the user, it will be called regardless of the ",(0,o.kt)("inlineCode",{parentName:"p"},"debug: false")," ",(0,o.kt)("a",{parentName:"p",href:"#debug"},"option"),"."))),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"theme"},"theme"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"object")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"No"))),(0,o.kt)("h4",{id:"description-10"},"Description"),(0,o.kt)("p",null,"Changes the color scheme theme of ",(0,o.kt)("a",{parentName:"p",href:"/configuration/pages"},"pages")," as well as allows some minor customization. Set ",(0,o.kt)("inlineCode",{parentName:"p"},"theme.colorScheme")," to ",(0,o.kt)("inlineCode",{parentName:"p"},'"light"'),", if you want to force pages to always be light. Set to ",(0,o.kt)("inlineCode",{parentName:"p"},'"dark"'),", if you want to force pages to always be dark. Set to ",(0,o.kt)("inlineCode",{parentName:"p"},'"auto"'),", (or leave this option out) if you want the pages to follow the preferred system theme. (Uses the ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme"},"prefers-color-scheme")," media query.)"),(0,o.kt)("p",null,"In addition, you can define a logo URL in ",(0,o.kt)("inlineCode",{parentName:"p"},"theme.logo")," which will be rendered above the main card in the default signin/signout/error/verify-request pages, as well as a ",(0,o.kt)("inlineCode",{parentName:"p"},"theme.brandColor")," which will affect the accent color of these pages."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'theme: {\n  colorScheme: "auto", // "auto" | "dark" | "light"\n  brandColor: "", // Hex color code\n  logo: "" // Absolute URL to image\n}\n')),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"advanced-options"},"Advanced Options"),(0,o.kt)("p",null,"Advanced options are passed the same way as basic options, but may have complex implications or side effects. You should try to avoid using advanced options unless you are very comfortable using them."),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"usesecurecookies"},"useSecureCookies"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"true")," for HTTPS sites / ",(0,o.kt)("inlineCode",{parentName:"li"},"false")," for HTTP sites"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"No"))),(0,o.kt)("h4",{id:"description-11"},"Description"),(0,o.kt)("p",null,"When set to ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," (the default for all site URLs that start with ",(0,o.kt)("inlineCode",{parentName:"p"},"https://"),") then all cookies set by NextAuth.js will only be accessible from HTTPS URLs."),(0,o.kt)("p",null,"This option defaults to ",(0,o.kt)("inlineCode",{parentName:"p"},"false")," on URLs that start with ",(0,o.kt)("inlineCode",{parentName:"p"},"http://")," (e.g. ",(0,o.kt)("inlineCode",{parentName:"p"},"http://localhost:3000"),") for developer convenience."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Properties on any custom ",(0,o.kt)("inlineCode",{parentName:"p"},"cookies")," that are specified override this option."))),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Setting this option to ",(0,o.kt)("em",{parentName:"p"},"false")," in production is a security risk and may allow sessions to be hijacked if used in production. It is intended to support development and testing. Using this option is not recommended."))),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"cookies"},"cookies"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Default value"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"{}")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Required"),": ",(0,o.kt)("em",{parentName:"li"},"No"))),(0,o.kt)("h4",{id:"description-12"},"Description"),(0,o.kt)("p",null,"Cookies in NextAuth.js are chunked by default, meaning that once they reach the 4kb limit, we will create a new cookie with the ",(0,o.kt)("inlineCode",{parentName:"p"},".{number}")," suffix and reassemble the cookies in the correct order when parsing / reading them. This was introduced to avoid size constraints which can occur when users want to store additional data in their sessionToken, for example."),(0,o.kt)("p",null,"You can override the default cookie names and options for any of the cookies used by NextAuth.js."),(0,o.kt)("p",null,"This is an advanced option and using it is not recommended as you may break authentication or introduce security flaws into your application."),(0,o.kt)("p",null,"You can specify one or more cookies with custom properties, but if you specify custom options for a cookie you must provide all the options for that cookie."),(0,o.kt)("p",null,"If you use this feature, you will likely want to create conditional behaviour to support setting different cookies policies in development and production builds, as you will be opting out of the built-in dynamic policy."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"An example of a use case for this option is to support sharing session tokens across subdomains."))),(0,o.kt)("h4",{id:"example"},"Example"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"cookies: {\n  sessionToken: {\n    name: `__Secure-next-auth.session-token`,\n    options: {\n      httpOnly: true,\n      sameSite: 'lax',\n      path: '/',\n      secure: true\n    }\n  },\n  callbackUrl: {\n    name: `__Secure-next-auth.callback-url`,\n    options: {\n      sameSite: 'lax',\n      path: '/',\n      secure: true\n    }\n  },\n  csrfToken: {\n    name: `__Host-next-auth.csrf-token`,\n    options: {\n      httpOnly: true,\n      sameSite: 'lax',\n      path: '/',\n      secure: true\n    }\n  },\n  pkceCodeVerifier: {\n    name: `${cookiePrefix}next-auth.pkce.code_verifier`,\n    options: {\n      httpOnly: true,\n      sameSite: 'lax',\n      path: '/',\n      secure: useSecureCookies\n    }\n  },\n  state: {\n    name: `${cookiePrefix}next-auth.state`,\n    options: {\n      httpOnly: true,\n      sameSite: \"lax\",\n      path: \"/\",\n      secure: useSecureCookies,\n    },\n  },\n}\n")),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Using a custom cookie policy may introduce security flaws into your application and is intended as an option for advanced users who understand the implications. Using this option is not recommended."))))}u.isMDXComponent=!0}}]);