"use strict";(self.webpackChunknext_auth_docs=self.webpackChunknext_auth_docs||[]).push([[2089],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return h}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=r.createContext({}),p=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},s=function(e){var t=p(e.components);return r.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},l=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,u=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),l=p(n),h=a,m=l["".concat(u,".").concat(h)]||l[h]||d[h]||o;return n?r.createElement(m,i(i({ref:t},s),{},{components:n})):r.createElement(m,i({ref:t},s))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=l;var c={};for(var u in t)hasOwnProperty.call(t,u)&&(c[u]=t[u]);c.originalType=e,c.mdxType="string"==typeof e?e:a,i[1]=c;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}l.displayName="MDXCreateElement"},4612:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return c},contentTitle:function(){return u},metadata:function(){return p},toc:function(){return s},default:function(){return l}});var r=n(7462),a=n(3366),o=(n(7294),n(3905)),i=["components"],c={id:"pouchdb",title:"PouchDB Adapter"},u="PouchDB",p={unversionedId:"adapters/pouchdb",id:"version-v3/adapters/pouchdb",isDocsHomePage:!1,title:"PouchDB Adapter",description:"This is the PouchDB Adapter for next-auth. This package can only be used in conjunction with the primary next-auth package. It is not a standalone package.",source:"@site/versioned_docs/version-v3/adapters/pouchdb.md",sourceDirName:"adapters",slug:"/adapters/pouchdb",permalink:"/v3/adapters/pouchdb",editUrl:"https://github.com/nextauthjs/docs/edit/main/versioned_docs/version-v3/adapters/pouchdb.md",tags:[],version:"v3",lastUpdatedBy:"Bal\xe1zs Orb\xe1n",lastUpdatedAt:1643982356,formattedLastUpdatedAt:"2/4/2022",frontMatter:{id:"pouchdb",title:"PouchDB Adapter"},sidebar:"version-v3/docs",previous:{title:"Firebase Adapter",permalink:"/v3/adapters/firebase"},next:{title:"42 School",permalink:"/v3/providers/42-school"}},s=[{value:"Getting Started",id:"getting-started",children:[],level:2},{value:"Advanced",id:"advanced",children:[{value:"Memory-First Caching Strategy",id:"memory-first-caching-strategy",children:[],level:3}],level:2}],d={toc:s};function l(e){var t=e.components,n=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"pouchdb"},"PouchDB"),(0,o.kt)("p",null,"This is the PouchDB Adapter for ",(0,o.kt)("a",{parentName:"p",href:"https://next-auth.js.org"},(0,o.kt)("inlineCode",{parentName:"a"},"next-auth")),". This package can only be used in conjunction with the primary ",(0,o.kt)("inlineCode",{parentName:"p"},"next-auth")," package. It is not a standalone package."),(0,o.kt)("p",null,"Depending on your architecture you can use PouchDB's http adapter to reach any database compliant with the CouchDB protocol (CouchDB, Cloudant, ...) or use any other PouchDB compatible adapter (leveldb, in-memory, ...)"),(0,o.kt)("h2",{id:"getting-started"},"Getting Started"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Prerequesite"),": Your PouchDB instance MUST provide the ",(0,o.kt)("inlineCode",{parentName:"p"},"pouchdb-find")," plugin since it is used internally by the adapter to build and manage indexes")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Install ",(0,o.kt)("inlineCode",{parentName:"li"},"next-auth")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"@next-auth/pouchdb-adapter@canary"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"npm install next-auth @next-auth/pouchdb-adapter@canary\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Add this adapter to your ",(0,o.kt)("inlineCode",{parentName:"li"},"pages/api/auth/[...nextauth].js")," next-auth configuration object")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="pages/api/auth/[...nextauth].js"',title:'"pages/api/auth/[...nextauth].js"'},'import NextAuth from "next-auth"\nimport Providers from "next-auth/providers"\nimport { PouchDBAdapter } from "@next-auth/pouchdb-adapter"\nimport PouchDB from "pouchdb"\n\n// Setup your PouchDB instance and database\nPouchDB.plugin(require("pouchdb-adapter-leveldb")) // Any other adapter\n  .plugin(require("pouchdb-find")) // Don\'t forget the `pouchdb-find` plugin\n\nconst pouchdb = new PouchDB("auth_db", { adapter: "leveldb" })\n\n// For more information on each option (and a full list of options) go to\n// https://next-auth.js.org/configuration/options\nexport default NextAuth({\n  // https://next-auth.js.org/configuration/providers\n  providers: [\n    Providers.Google({\n      clientId: process.env.GOOGLE_ID,\n      clientSecret: process.env.GOOGLE_SECRET,\n    }),\n  ],\n  adapter: PouchDBAdapter(pouchdb),\n  // ...\n})\n')),(0,o.kt)("h2",{id:"advanced"},"Advanced"),(0,o.kt)("h3",{id:"memory-first-caching-strategy"},"Memory-First Caching Strategy"),(0,o.kt)("p",null,"If you need to boost your authentication layer performance, you may use PouchDB's powerful sync features and various adapters, to build a memory-first caching strategy."),(0,o.kt)("p",null,"Use an in-memory PouchDB as your main authentication database, and synchronize it with any other persisted PouchDB. You may do a one way, one-off replication at startup from the persisted PouchDB into the in-memory PouchDB, then two-way, continuous, retriable sync."),(0,o.kt)("p",null,"This will most likely not increase performance much in a serverless environment due to various reasons such as concurrency, function startup time increases, etc."),(0,o.kt)("p",null,"For more details, please see ",(0,o.kt)("a",{parentName:"p",href:"https://pouchdb.com/api.html#sync"},"https://pouchdb.com/api.html#sync")))}l.isMDXComponent=!0}}]);