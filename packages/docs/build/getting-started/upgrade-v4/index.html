<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="search" type="application/opensearchdescription+xml" title="NextAuth.js" href="/opensearch.xml"><title data-react-helmet="true">Upgrade Guide (v4) | NextAuth.js</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://next-auth.js.org/getting-started/upgrade-v4"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Upgrade Guide (v4) | NextAuth.js"><meta data-react-helmet="true" name="description" content="NextAuth.js version 4 includes a few breaking changes from the last major version (3.x). So we&#x27;re here to help you upgrade your applications as smoothly as possible. It should be possible to upgrade from any version of 3.x to the latest 4 release by following the next few migration steps."><meta data-react-helmet="true" property="og:description" content="NextAuth.js version 4 includes a few breaking changes from the last major version (3.x). So we&#x27;re here to help you upgrade your applications as smoothly as possible. It should be possible to upgrade from any version of 3.x to the latest 4 release by following the next few migration steps."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://next-auth.js.org/getting-started/upgrade-v4"><link data-react-helmet="true" rel="alternate" href="https://next-auth.js.org/getting-started/upgrade-v4" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://next-auth.js.org/getting-started/upgrade-v4" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.c5d64eef.css">
<link rel="preload" href="/assets/js/runtime~main.28f43299.js" as="script">
<link rel="preload" href="/assets/js/main.483d9878.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo/logo-xs.png" alt="NextAuth Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo/logo-xs.png" alt="NextAuth Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">NextAuth.js</b></a><a class="navbar__item navbar__link" href="/getting-started/introduction">Documentation</a><a class="navbar__item navbar__link" href="/tutorials">Tutorials</a><a class="navbar__item navbar__link" href="/faq">FAQ</a><a class="navbar__item navbar__link" href="/security">Security</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/getting-started/introduction">v4</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/getting-started/upgrade-v4">v4</a></li><li><a class="dropdown__link" href="/v3/getting-started/introduction">v3</a></li><li><a href="https://github.com/nextauthjs/next-auth/releases" target="_blank" rel="noopener noreferrer" class="dropdown__link">All Releases</a></li></ul></div><a href="https://www.npmjs.com/package/next-auth" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">npm</a><a href="https://github.com/nextauthjs/next-auth" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">üåëÔ∏è</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">üí°</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_NKBi"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Getting Started</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/example">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/client">Client API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/rest-api">REST API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/typescript">TypeScript</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/getting-started/upgrade-v4">Upgrade Guide (v4)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Configuration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Providers</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Adapters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/warnings">Warnings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/errors">Errors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/deployment">Deployment</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->v4</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Upgrade Guide (v4)</h1></header><p>NextAuth.js version 4 includes a few breaking changes from the last major version (3.x). So we&#x27;re here to help you upgrade your applications as smoothly as possible. It should be possible to upgrade from any version of 3.x to the latest 4 release by following the next few migration steps.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Version 4 has been released to GA üö®</p><p>We encourage users to try it out and report any and all issues they come across.</p></div></div><p>You can upgrade to the new version by running:</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_vU9c tabs__item--active">npm</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">Yarn</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">install</span><span class="token plain"> next-auth</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">yarn</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">add</span><span class="token plain"> next-auth</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="next-authjwt"><code>next-auth/jwt</code><a aria-hidden="true" class="hash-link" href="#next-authjwt" title="Direct link to heading">‚Äã</a></h2><p>We no longer have a default export in <code>next-auth/jwt</code>.
To comply with this, change the following:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> import jwt from &quot;next-auth/jwt&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> import { getToken } from &quot;next-auth/jwt&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="next-authreact"><code>next-auth/react</code><a aria-hidden="true" class="hash-link" href="#next-authreact" title="Direct link to heading">‚Äã</a></h2><p>We&#x27;ve renamed the client-side import source to <code>next-auth/react</code>. To comply with this change, you will simply have to rename anywhere you were using <code>next-auth/client</code>.</p><p>For example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> import { useSession } from &quot;next-auth/client&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> import { useSession } from &quot;next-auth/react&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We&#x27;ve also made the following changes to the names of the exports:</p><ul><li><code>setOptions</code>: Not exposed anymore, use <a href="https://next-auth.js.org/getting-started/client#options" target="_blank" rel="noopener noreferrer"><code>SessionProvider</code> props</a></li><li><code>options</code>: Not exposed anymore, <a href="https://next-auth.js.org/getting-started/client#options" target="_blank" rel="noopener noreferrer">use <code>SessionProvider</code> props</a></li><li><code>session</code>: Renamed to <code>getSession</code></li><li><code>providers</code>: Renamed to <code>getProviders</code></li><li><code>csrfToken</code>: Renamed to <code>getCsrfToken</code></li><li><code>signin</code>: Renamed to <code>signIn</code></li><li><code>signout</code>: Renamed to <code>signOut</code></li><li><code>Provider</code>: Renamed to <code>SessionProvider</code></li></ul><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.12" target="_blank" rel="noopener noreferrer">https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.12</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="sessionprovider"><code>SessionProvider</code><a aria-hidden="true" class="hash-link" href="#sessionprovider" title="Direct link to heading">‚Äã</a></h2><p>Version 4 makes using the <code>SessionProvider</code> mandatory. This means that you will have to wrap any part of your application using <code>useSession</code> in this provider, if you were not doing so already. The <code>SessionProvider</code> has also undergone a few further changes:</p><ul><li><code>Provider</code> is renamed to <code>SessionProvider</code></li><li>The options prop is now flattened as the props of SessionProvider.</li><li><code>keepAlive</code> has been renamed to <code>refetchInterval</code>.</li><li><code>clientMaxAge</code> has been removed in favor of <code>refetchInterval</code>, as they overlap in functionality, with the difference that <code>refetchInterval</code> will keep re-fetching the session periodically in the background.</li></ul><p>The best practice for wrapping your app in Providers is to do so in your <code>pages/_app.jsx</code> file.</p><p>An example use-case with these new changes:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI jsx"><pre tabindex="0" class="prism-code language-jsx codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> SessionProvider </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;next-auth/react&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">default</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">App</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token parameter">  Component</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token parameter">  pageProps</span><span class="token parameter operator" style="color:rgb(212, 212, 212)">:</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token parameter"> session</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> </span><span class="token parameter operator" style="color:rgb(212, 212, 212)">...</span><span class="token parameter">pageProps </span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token parameter"></span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// `session` comes from `getServerSideProps` or `getInitialProps`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// Avoids flickering/session loading on first load.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag class-name" style="color:rgb(78, 201, 176)">SessionProvider</span><span class="token tag" style="color:rgb(78, 201, 176)"> </span><span class="token tag attr-name" style="color:rgb(156, 220, 254)">session</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(212, 212, 212)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token tag script language-javascript" style="color:rgb(78, 201, 176)">session</span><span class="token tag script language-javascript punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token tag" style="color:rgb(78, 201, 176)"> </span><span class="token tag attr-name" style="color:rgb(156, 220, 254)">refetchInterval</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(212, 212, 212)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token tag script language-javascript number" style="color:rgb(181, 206, 168)">5</span><span class="token tag script language-javascript" style="color:rgb(78, 201, 176)"> </span><span class="token tag script language-javascript operator" style="color:rgb(212, 212, 212)">*</span><span class="token tag script language-javascript" style="color:rgb(78, 201, 176)"> </span><span class="token tag script language-javascript number" style="color:rgb(181, 206, 168)">60</span><span class="token tag script language-javascript punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag class-name" style="color:rgb(78, 201, 176)">Component</span><span class="token tag" style="color:rgb(78, 201, 176)"> </span><span class="token tag spread punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token tag spread punctuation" style="color:rgb(212, 212, 212)">...</span><span class="token tag spread attr-value" style="color:rgb(206, 145, 120)">pageProps</span><span class="token tag spread punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token tag" style="color:rgb(78, 201, 176)"> </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag class-name" style="color:rgb(78, 201, 176)">SessionProvider</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.12" target="_blank" rel="noopener noreferrer">https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.12</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="providers">Providers<a aria-hidden="true" class="hash-link" href="#providers" title="Direct link to heading">‚Äã</a></h2><p>Providers now need to be imported individually.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> import Provider from &quot;next-auth/providers&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> Providers.Auth0({...})</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> Providers.Google({...})</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> import Auth0Provider from &quot;next-auth/providers/auth0&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> import GoogleProvider from &quot;next-auth/providers/google&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> Auth0Provider({...})</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> GoogleProvider({...})</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol><li>The <code>AzureADB2C</code> provider has been renamed <code>AzureAD</code>.</li><li>The <code>Basecamp</code> provider has been removed, see explanation <a href="https://github.com/basecamp/api/blob/master/sections/authentication.md#on-authenticating-users-via-oauth" target="_blank" rel="noopener noreferrer">here</a>.</li><li>The GitHub provider by default now will not request full write access to user profiles. If you need this scope, please add <code>user</code> to the scope option manually.</li></ol><p>The following new options are available when defining your Providers in the configuration:</p><ol><li><code>authorization</code> (replaces <code>authorizationUrl</code>, <code>authorizationParams</code>, <code>scope</code>)</li><li><code>token</code> replaces (<code>accessTokenUrl</code>, <code>headers</code>, <code>params</code>)</li><li><code>userinfo</code> (replaces <code>profileUrl</code>)</li><li><code>issuer</code>(replaces <code>domain</code>)</li></ol><p>For more details on their usage, please see <a href="/configuration/providers/oauth#options">options</a> section of the OAuth Provider documentation.</p><p>When submitting a new OAuth provider to the repository, the <code>profile</code> callback is expected to only return these fields from now on: <code>id</code>, <code>name</code>, <code>email</code>, and <code>image</code>. If any of these are missing values, they should be set to <code>null</code>.</p><p>Also worth noting is that <code>id</code> is expected to be returned as a <code>string</code> type (For example if your provider returns it as a number, you can cast it by using the <code>.toString()</code> method). This makes the returned profile object comply across all providers/accounts/adapters, and hopefully cause less confusion in the future.</p><p>Implemented in: <a href="https://github.com/nextauthjs/next-auth/pull/2411" target="_blank" rel="noopener noreferrer">nextauthjs/next-auth#2411</a>
Introduced in <a href="https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.20" target="_blank" rel="noopener noreferrer">https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.20</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="usesession-hook"><code>useSession</code> Hook<a aria-hidden="true" class="hash-link" href="#usesession-hook" title="Direct link to heading">‚Äã</a></h2><p>The <code>useSession</code> hook has been updated to return an object. This allows you to test states much more cleanly with the new <code>status</code> option.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> const [ session, loading ] = useSession()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> const { data: session, status } = useSession()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> const loading = status === &quot;loading&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><a href="https://next-auth.js.org/getting-started/client#usesession" target="_blank" rel="noopener noreferrer">Check the docs</a> for the possible values of both <code>session.status</code> and <code>session.data</code>.</p><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.18" target="_blank" rel="noopener noreferrer">https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.18</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="named-parameters">Named Parameters<a aria-hidden="true" class="hash-link" href="#named-parameters" title="Direct link to heading">‚Äã</a></h2><p>We have changed the arguments to our callbacks to the named parameters pattern. This way you don&#x27;t have to use dummy <code>_</code> placeholders or other tricks.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="callbacks">Callbacks<a aria-hidden="true" class="hash-link" href="#callbacks" title="Direct link to heading">‚Äã</a></h3><p>The signatures for the callback methods now look like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> signIn(user, account, profileOrEmailOrCredentials)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> signIn({ user, account, profile, email, credentials })</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> redirect(url, baseUrl)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> redirect({ url, baseUrl })</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> session(session, tokenOrUser)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> session({ session, token, user })</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> jwt(token, user, account, OAuthProfile, isNewUser)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> jwt({ token, user, account, profile, isNewUser })</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.17" target="_blank" rel="noopener noreferrer">https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.17</a></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="events">Events<a aria-hidden="true" class="hash-link" href="#events" title="Direct link to heading">‚Äã</a></h3><p>Two event signatures have changed to also use the named parameters pattern, <code>signOut</code> and <code>updateUser</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// [...nextauth].js</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">events: {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> signOut(tokenOrSession),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> signOut({ token, session }), // token if using JWT, session if DB persisted sessions.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> updateUser(user)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> updateUser({ user })</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.20" target="_blank" rel="noopener noreferrer">https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.20</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="jwt-configuration">JWT configuration<a aria-hidden="true" class="hash-link" href="#jwt-configuration" title="Direct link to heading">‚Äã</a></h2><p>We have removed some of the <a href="/configuration/options">configuration options</a> when using JSON Web Tokens, <a href="https://github.com/nextauthjs/next-auth/pull/3039" target="_blank" rel="noopener noreferrer">here&#x27;s the PR</a> for more context.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">export default NextAuth({</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> // ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> jwt: {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   secret,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   maxAge,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">   encryptionKey</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">   signingKey</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">   encryptionKey</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">   verificationOptions</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   encode({</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       token</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       secret</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       maxAge</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       signingKey</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       signingOptions</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       encryptionKey</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       encryptionOptions</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       encryption</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   }) {},</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   decode({</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       token</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       secret</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       maxAge</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       signingKey</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       verificationKey</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       verificationOptions</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       encryptionKey</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       decryptionKey</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       decryptionOptions</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">       encryption</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   }) {}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token plain">})</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="logger-api">Logger API<a aria-hidden="true" class="hash-link" href="#logger-api" title="Direct link to heading">‚Äã</a></h2><p>The logger API has been simplified to use at most two parameters, where the second is usually an object (<code>metadata</code>) containing an <code>error</code> object. If you are not using the logger settings you can ignore this change.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// [...nextauth.js]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import log from &quot;some-logger-service&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">logger: {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> error(code, ...message) {},</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> error(code, metadata) {},</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> warn(code, ...message) {},</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> warn(code) {}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> debug(code, ...message) {}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> debug(code, metadata) {}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.19" target="_blank" rel="noopener noreferrer">https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.19</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="nodemailer"><code>nodemailer</code><a aria-hidden="true" class="hash-link" href="#nodemailer" title="Direct link to heading">‚Äã</a></h2><p>Like <code>typeorm</code> and <code>prisma</code>, <a href="https://npmjs.com/package/nodemailer" target="_blank" rel="noopener noreferrer"><code>nodemailer</code></a> is no longer included as a dependency by default. If you are using the Email provider you must install it in your project manually, or use any other Email library in the <a href="/configuration/providers/email#options-1#:~:text=sendVerificationRequest"><code>sendVerificationRequest</code></a> callback. This reduces bundle size for those not actually using the Email provider. Remember, when using the Email provider, it is mandatory to also use a database adapter due to the fact that verification tokens need to be persisted longer term for the magic link functionality to work.</p><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.2" target="_blank" rel="noopener noreferrer">https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.2</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="theme">Theme<a aria-hidden="true" class="hash-link" href="#theme" title="Direct link to heading">‚Äã</a></h2><p>We have added some basic customization options to our built-in pages like <code>signin</code>, <code>signout</code>, etc.</p><p>These can be set under the <code>theme</code> configuration key. This used to be a string which only controlled the color scheme option. Now it is an object with the following options:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">theme</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  colorScheme</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;auto&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// &quot;auto&quot; | &quot;dark&quot; | &quot;light&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  brandColor</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Hex color value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  logo</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Absolute URL to logo image</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The hope is that with some minimal configuration / customization options, users won&#x27;t immediately feel the need to replace the built-in pages with their own.</p><p>More details and screenshots of the new theme options can be found under <a href="https://next-auth.js.org/configuration/pages#theming" target="_blank" rel="noopener noreferrer">configuration/pages</a>.</p><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/pull/2788" target="_blank" rel="noopener noreferrer">nextauthjs/next-auth#2788</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="session">Session<a aria-hidden="true" class="hash-link" href="#session" title="Direct link to heading">‚Äã</a></h2><p>The <code>session.jwt: boolean</code> option has been renamed to <code>session.strategy: &quot;jwt&quot; | &quot;database&quot;</code>. The goal is to make the user&#x27;s options more intuitive:</p><ol><li>No adapter, <code>strategy: &quot;jwt&quot;</code>: This is the default. The session is saved in a cookie and never persisted anywhere.</li><li>With Adapter, <code>strategy: &quot;database&quot;</code>: If an Adapter is defined, this will be the implicit setting. No user config is needed.</li><li>With Adapter, <code>strategy: &quot;jwt&quot;</code>: The user can explicitly instruct <code>next-auth</code> to use JWT even if a database is available. This can result in faster lookups in compromise of lowered security. Read more about: <a href="https://next-auth.js.org/faq#json-web-tokens" target="_blank" rel="noopener noreferrer">https://next-auth.js.org/faq#json-web-tokens</a></li></ol><p>Example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">session: {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> jwt: true,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> strategy: &quot;jwt&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/pull/3144" target="_blank" rel="noopener noreferrer">nextauthjs/next-auth#3144</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="adapters">Adapters<a aria-hidden="true" class="hash-link" href="#adapters" title="Direct link to heading">‚Äã</a></h2><p>Most importantly, the core <code>next-auth</code> package no longer ships with <code>typeorm</code> or any other database adapter by default. This brings the default bundle size down significantly for those not needing to persist user data to a database.</p><p>You can find the official Adapters in the newly created <a href="https://github.com/nextauthjs/adapters" target="_blank" rel="noopener noreferrer">nextauthjs/adapter</a> repository. Although you can still <a href="/tutorials/creating-a-database-adapter">create your own</a> with a new, <a href="https://github.com/nextauthjs/next-auth/pull/2361" target="_blank" rel="noopener noreferrer">simplified Adapter API</a>.</p><ol><li>If you use the built-in TypeORM or Prisma adapters, these have been removed from the core <code>next-auth</code> package. Thankfully the migration is easy; you just need to install the external packages for your database and change the import in your <code>[...nextauth].js</code>.</li></ol><p>The <code>database</code> option has been removed, you must now do the following instead:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// [...nextauth].js</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import NextAuth from &quot;next-auth&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> import { TypeORMLegacyAdapter } from &quot;@next-auth/typeorm-legacy-adapter&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">export default NextAuth({</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">  database: &quot;yourconnectionstring&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)">  adapter: TypeORMLegacyAdapter(&quot;yourconnectionstring&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token plain">})</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li><p>The <code>prisma-legacy</code> adapter has been removed, please use the <a href="https://npmjs.com/package/@next-auth/prisma-adapter" target="_blank" rel="noopener noreferrer"><code>@next-auth/prisma-adapter</code></a> instead.</p></li><li><p>The <code>typeorm-legacy</code> adapter has been upgraded to use the newer adapter API, but has retained the <code>typeorm-legacy</code> name. We aim to migrate this to individual lighter weight adapters for each database type in the future, or switch out <code>typeorm</code>.</p></li><li><p>MongoDB has been moved to its own adapter under <code>@next-auth/mongodb-adapter</code>. See the <a href="/adapters/mongodb">MongoDB Adapter docs</a>.</p></li></ol><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.8" target="_blank" rel="noopener noreferrer">https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.8</a> and <a href="https://github.com/nextauthjs/next-auth/pull/2361" target="_blank" rel="noopener noreferrer">nextauthjs/next-auth#2361</a></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="adapter-api">Adapter API<a aria-hidden="true" class="hash-link" href="#adapter-api" title="Direct link to heading">‚Äã</a></h3><p><strong>This does not require any changes from the user - these are adapter specific changes only</strong></p><p>The Adapter API has been rewritten and significantly simplified in NextAuth v4. The adapters now have less work to do as some functionality has been migrated to the core of NextAuth, like hashing the <a href="/adapters/models/#verification-token">verification token</a>.</p><p>If you are an adapter maintainer or are interested in writing your own adapter, you can find more information about this change in <a href="https://github.com/nextauthjs/next-auth/pull/2361" target="_blank" rel="noopener noreferrer">nextauthjs/next-auth#2361</a> and release <a href="https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.22" target="_blank" rel="noopener noreferrer">https://github.com/nextauthjs/next-auth/releases/tag/v4.0.0-next.22</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="schema-changes">Schema changes<a aria-hidden="true" class="hash-link" href="#schema-changes" title="Direct link to heading">‚Äã</a></h3><p>The way we save data with adapters have slightly changed. With the new Adapter API, we wanted to make it easier to extend your database with additional fields. For example if your User needs an extra <code>phone</code> field, it should be enough to add that to your database&#x27;s schema, and no changes will be necessary in your adapter.</p><ul><li><code>created_at</code>/<code>createdAt</code> and <code>updated_at</code>/<code>updatedAt</code> fields are removed from all Models.</li><li><code>user_id</code>/<code>userId</code> consistently named <code>userId</code>.</li><li><code>compound_id</code>/<code>compoundId</code> is removed from Account.</li><li><code>access_token</code>/<code>accessToken</code> is removed from Session.</li><li><code>email_verified</code>/<code>emailVerified</code> on User is consistently named <code>email_verified</code>.</li><li><code>provider_id</code>/<code>providerId</code> renamed to <code>provider</code> on Account</li><li><code>provider_type</code>/<code>providerType</code> renamed to <code>type</code> on Account</li><li><code>provider_account_id</code>/<code>providerAccountId</code> on Account is consistently named <code>providerAccountId</code></li><li><code>access_token_expires</code>/<code>accessTokenExpires</code> on Account renamed to <code>expires_at</code></li><li>New fields on Account: <code>token_type</code>, <code>scope</code>, <code>id_token</code>, <code>session_state</code></li><li><code>verification_requests</code> table has been renamed to <code>verification_tokens</code></li></ul><details class="details_Q743 alert alert--info details_h+cY" data-collapsed="true"><summary>See the changes</summary><div><div class="collapsibleContent_K5uX"><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI diff"><pre tabindex="0" class="prism-code language-diff codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">User {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> id</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> name</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> email</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> emailVerified</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> email_verified</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> image</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">  created_at</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">  updated_at</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Account {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> id</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> compound_id</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> user_id</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> userId</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">  provider_type</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> type</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> provider_id</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> provider</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> provider_account_id</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> providerAccountId</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> refresh_token</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> access_token</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> access_token_expires</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> expires_in</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> expires_at</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> token_type</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> scope</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> id_token</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(181, 206, 168)">+</span><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"> session_state</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token inserted-sign inserted line" style="color:rgb(181, 206, 168)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> created_at</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> updated_at</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Session {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> id</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> userId</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> expires</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> sessionToken</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> access_token</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> created_at</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"> updated_at</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">VerificationToken {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> id</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> token</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> expires</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> identifier</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">  created_at</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(206, 145, 120)">-</span><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)">  updated_at</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token deleted-sign deleted line" style="color:rgb(206, 145, 120)"></span><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></div></details><p>For more info, see the <a href="/adapters/models">Models page</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="missing-secret">Missing <code>secret</code><a aria-hidden="true" class="hash-link" href="#missing-secret" title="Direct link to heading">‚Äã</a></h2><p>NextAuth.js used to generate a secret for convenience, when the user did not define one. This might have been useful in development, but can be a concern in production. We have always been clear about that in the docs, but from now on, if you forget to define a <code>secret</code> property in production, we will show the user an error page. Read more about this option <a href="https://next-auth.js.org/configuration/options#secret" target="_blank" rel="noopener noreferrer">here</a></p><p>You can generate a secret to be placed in the <code>secret</code> configuration option via the following command:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ openssl rand -base64 </span><span class="token number" style="color:rgb(181, 206, 168)">32</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Therefore, your NextAuth.js config should look something like this:</p><div class="codeBlockContainer_J+bg"><div style="color:#9CDCFE;background-color:#1E1E1E" class="codeBlockTitle_oQzk">/pages/api/auth/[...nextauth].js</div><div class="codeBlockContent_csEI javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">default</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">NextAuth</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  providers</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  secret</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;LlKq6ZtYbr+hTC073mAmAh9/h2HwMfsFo4hrfCx5mLg=&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/issues/3143" target="_blank" rel="noopener noreferrer">nextauthjs/next-auth#3143</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="session-strategy">Session <code>strategy</code><a aria-hidden="true" class="hash-link" href="#session-strategy" title="Direct link to heading">‚Äã</a></h2><p>We have always supported two different session strategies. The first being our most popular and default strategy - the JWT based one. The second is the database adapter persisted session strategy. Both have their advantages/disadvantages, you can learn more about them on the <a href="https://next-auth.js.org/faq" target="_blank" rel="noopener noreferrer">FAQ</a> page.</p><p>Previously, the way you configured this was through the <code>jwt: boolean</code> flag in the <code>session</code> option. The names <code>session</code> and <code>jwt</code> might have been a bit overused in the options, and so for a clearer message, we renamed this option to <code>strategy: &quot;jwt&quot; | &quot;database&quot;</code>, it is still in the <code>session</code> object. This will hopefully better indicate the purpose of this option as well as make very explicit which type of session you are going to use.</p><p>See the <a href="https://next-auth.js.org/configuration/options#session" target="_blank" rel="noopener noreferrer"><code>session</code> option docs</a> for more details.</p><p>Introduced in <a href="https://github.com/nextauthjs/next-auth/pull/3144" target="_blank" rel="noopener noreferrer">nextauthjs/next-auth#3144</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="summary">Summary<a aria-hidden="true" class="hash-link" href="#summary" title="Direct link to heading">‚Äã</a></h2><p>We hope this migration goes smoothly for each and every one of you! If you have any questions or get stuck anywhere, feel free to create <a href="https://github.com/nextauthjs/next-auth/issues/new" target="_blank" rel="noopener noreferrer">a new issue</a> on GitHub.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/nextauthjs/docs/edit/main/docs/getting-started/upgrade-to-v4.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-02-04T13:45:56.000Z">2/4/2022</time></b> by <b>Bal√°zs Orb√°n</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/getting-started/typescript"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ <!-- -->TypeScript</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/configuration/initialization"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Initialization<!-- --> ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#next-authjwt" class="table-of-contents__link toc-highlight"><code>next-auth/jwt</code></a></li><li><a href="#next-authreact" class="table-of-contents__link toc-highlight"><code>next-auth/react</code></a></li><li><a href="#sessionprovider" class="table-of-contents__link toc-highlight"><code>SessionProvider</code></a></li><li><a href="#providers" class="table-of-contents__link toc-highlight">Providers</a></li><li><a href="#usesession-hook" class="table-of-contents__link toc-highlight"><code>useSession</code> Hook</a></li><li><a href="#named-parameters" class="table-of-contents__link toc-highlight">Named Parameters</a><ul><li><a href="#callbacks" class="table-of-contents__link toc-highlight">Callbacks</a></li><li><a href="#events" class="table-of-contents__link toc-highlight">Events</a></li></ul></li><li><a href="#jwt-configuration" class="table-of-contents__link toc-highlight">JWT configuration</a></li><li><a href="#logger-api" class="table-of-contents__link toc-highlight">Logger API</a></li><li><a href="#nodemailer" class="table-of-contents__link toc-highlight"><code>nodemailer</code></a></li><li><a href="#theme" class="table-of-contents__link toc-highlight">Theme</a></li><li><a href="#session" class="table-of-contents__link toc-highlight">Session</a></li><li><a href="#adapters" class="table-of-contents__link toc-highlight">Adapters</a><ul><li><a href="#adapter-api" class="table-of-contents__link toc-highlight">Adapter API</a></li><li><a href="#schema-changes" class="table-of-contents__link toc-highlight">Schema changes</a></li></ul></li><li><a href="#missing-secret" class="table-of-contents__link toc-highlight">Missing <code>secret</code></a></li><li><a href="#session-strategy" class="table-of-contents__link toc-highlight">Session <code>strategy</code></a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">About NextAuth.js</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/getting-started/introduction">Introduction</a></li><li class="footer__item">
            <a target="_blank" rel="noopener noreferrer" href="https://vercel.com?utm_source=nextauthjs&utm_campaign=oss">
              <img alt="Powered by Vercel" style="margin-top: 8px" height="32" src="https://raw.githubusercontent.com/nextauthjs/docs/main/static/img/powered-by-vercel.svg">
            </a></li></ul></div><div class="col footer__col"><div class="footer__title">Download</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/nextauthjs/next-auth" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://www.npmjs.com/package/next-auth" target="_blank" rel="noopener noreferrer" class="footer__link-item">NPM</a></li></ul></div><div class="col footer__col"><div class="footer__title">Acknowledgements</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/contributors">Contributors</a></li><li class="footer__item"><a href="https://opencollective.com/nextauth" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsors</a></li><li class="footer__item"><a href="https://undraw.co/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Images by unDraw</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">NextAuth.js &copy; Iain Collins 2022</div></div></div></footer></div>
<script src="/assets/js/runtime~main.28f43299.js"></script>
<script src="/assets/js/main.483d9878.js"></script>
</body>
</html>