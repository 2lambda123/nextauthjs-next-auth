---
id: supabase
title: Supabase
---

# Supabase

This is the Supabase Adapter for [`next-auth`](https://next-auth.js.org). This package can only be used in conjunction with the primary `next-auth` package. It is not a standalone package.

## Getting Started

1. Install `@supabase/supabase-js`, `next-auth` and `@next-auth/supabase-adapter`.

```bash npm2yarn2pnpm
npm install @supabase/supabase-js next-auth @next-auth/supabase-adapter
```

2. Add this adapter to your `pages/api/[...nextauth].js` next-auth configuration object.

```js
import NextAuth from "next-auth"
import { SupabaseAdapter } from "@next-auth/supabase-adapter"
import { createClient } from "@supabase/supabase-js"

const supabase = createClient(
  process.env.SUPABASE_URL,
  process.env.SUPABASE_KEY
)

// For more information on each option (and a full list of options) go to
// https://next-auth.js.org/configuration/options
export default NextAuth({
  // https://next-auth.js.org/configuration/providers
  providers: [...],
  adapter: SupabaseAdapter(supabase),
  // ...
})
```

## Schema

Setup your database as described in our main [schema](/adapters/models), either by using
the Supabase UI Editor or running a SQL Schema similar to the one below in the Supabase SQL Editor
or using the Supabase [CLI](https://supabase.com/docs/reference/cli/about).

```sql
CREATE TABLE IF NOT EXISTS public.users
(
		id text COLLATE pg_catalog."default" NOT NULL DEFAULT uuid_generate_v4(),
		name text COLLATE pg_catalog."default",
		email text COLLATE pg_catalog."default",
		"emailVerified" timestamp with time zone,
		image text COLLATE pg_catalog."default",
		CONSTRAINT users_pkey PRIMARY KEY (id)
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public.users
		OWNER to postgres;

GRANT ALL ON TABLE public.users TO anon;

GRANT ALL ON TABLE public.users TO authenticated;

GRANT ALL ON TABLE public.users TO postgres;

GRANT ALL ON TABLE public.users TO service_role;


CREATE TABLE IF NOT EXISTS public.sessions
(
		id text COLLATE pg_catalog."default" NOT NULL DEFAULT uuid_generate_v4(),
		expires timestamp with time zone,
		"sessionToken" text COLLATE pg_catalog."default",
		"userId" text COLLATE pg_catalog."default",
		CONSTRAINT sessions_pkey PRIMARY KEY (id),
		CONSTRAINT "sessions_userId_fkey" FOREIGN KEY ("userId")
				REFERENCES public.users (id) MATCH SIMPLE
				ON UPDATE NO ACTION
				ON DELETE CASCADE
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public.sessions
		OWNER to postgres;

GRANT ALL ON TABLE public.sessions TO anon;

GRANT ALL ON TABLE public.sessions TO authenticated;

GRANT ALL ON TABLE public.sessions TO postgres;

GRANT ALL ON TABLE public.sessions TO service_role;


CREATE TABLE IF NOT EXISTS public.accounts
(
		id text COLLATE pg_catalog."default" NOT NULL DEFAULT uuid_generate_v4(),
		type text COLLATE pg_catalog."default",
		provider text COLLATE pg_catalog."default",
		"providerAccountId" text COLLATE pg_catalog."default",
		refresh_token text COLLATE pg_catalog."default",
		access_token text COLLATE pg_catalog."default",
		expires_at bigint,
		token_type text COLLATE pg_catalog."default",
		scope text COLLATE pg_catalog."default",
		id_token text COLLATE pg_catalog."default",
		session_state text COLLATE pg_catalog."default",
		oauth_token_secret text COLLATE pg_catalog."default",
		oauth_token text COLLATE pg_catalog."default",
		"userId" text COLLATE pg_catalog."default",
		CONSTRAINT accounts_pkey PRIMARY KEY (id),
		CONSTRAINT "accounts_userId_fkey" FOREIGN KEY ("userId")
				REFERENCES public.users (id) MATCH SIMPLE
				ON UPDATE NO ACTION
				ON DELETE CASCADE
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public.accounts
		OWNER to postgres;

GRANT ALL ON TABLE public.accounts TO anon;

GRANT ALL ON TABLE public.accounts TO authenticated;

GRANT ALL ON TABLE public.accounts TO postgres;

GRANT ALL ON TABLE public.accounts TO service_role;


CREATE TABLE IF NOT EXISTS public.verification_tokens
(
		id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
		identifier text COLLATE pg_catalog."default",
		token text COLLATE pg_catalog."default",
		expires timestamp with time zone,
		CONSTRAINT verification_tokens_pkey PRIMARY KEY (id)
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public.verification_tokens
		OWNER to postgres;

GRANT ALL ON TABLE public.verification_tokens TO anon;

GRANT ALL ON TABLE public.verification_tokens TO authenticated;

GRANT ALL ON TABLE public.verification_tokens TO postgres;

GRANT ALL ON TABLE public.verification_tokens TO service_role;
```
